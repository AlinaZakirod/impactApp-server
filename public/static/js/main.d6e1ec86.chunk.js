(this["webpackJsonpptwd-client"]=this["webpackJsonpptwd-client"]||[]).push([[0],{34:function(e,t,a){e.exports=a(64)},39:function(e,t,a){},40:function(e,t,a){},64:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(31),c=a.n(o),s=(a(39),a(11)),l=a(3),i=a(4),u=a(6),m=a(5),g=a(7),d=(a(40),a(8)),h=Object(d.a)(),p=a(2),E=a.n(p),f=a(14),y=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={fullName:"",email:"",password:"",message:null},a}return Object(g.a)(t,e),Object(i.a)(t,[{key:"genericSync",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(s.a)({},a,n))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),E.a.post("".concat("https://impact-sustainability.herokuapp.com/","/api/signup"),this.state,{withCredentials:!0}).then((function(e){var a=e.data.updatedUserSuggestedActs;t.props.onUserChange(a),t.props.history.push("/")})).catch((function(e){if(e.response.data)return t.setState({message:e.response.data.message})}))}},{key:"render",value:function(){var e=this;console.log("Do I have user in Signup: ",this.props.currentUser),console.log(" what is this >>>>>> ",this);var t=this.state,a=t.fullName,n=t.email,o=t.password;return this.props.currentUser?r.a.createElement("div",null,r.a.createElement("h2",null,"Welcome to your app, ",this.props.currentUser.fullName," ! You're signed in!"," ")):r.a.createElement("section",{className:"hero is-success  is-fullheight",src:"../../public/landing-page.jpg"},r.a.createElement("div",{className:"hero-body"},r.a.createElement("div",{className:"column is-one-fifth"}),r.a.createElement("div",{className:"column is-one-third has-text-left"},r.a.createElement("h2",{className:"title is-1"},"Sign up "),r.a.createElement("form",{onSubmit:function(t){e.handleSubmit(t)}},r.a.createElement("div",{className:"control"},r.a.createElement("label",{className:"label"}," Full name: "),r.a.createElement("input",{className:"input",value:a,onChange:function(t){return e.genericSync(t)},type:"text",name:"fullName",placeholder:"Full Name"})),r.a.createElement("div",{className:"control"},r.a.createElement("label",{className:"label"}," Email: "),r.a.createElement("input",{className:"input",value:n,onChange:function(t){return e.genericSync(t)},type:"email",name:"email",placeholder:"my-email@email.com"})),r.a.createElement("div",{className:"control"},r.a.createElement("label",{className:"label"}," Password"),r.a.createElement("input",{className:"input",value:o,onChange:function(t){return e.genericSync(t)},type:"password",name:"password",placeholder:"***********"})),r.a.createElement("button",{className:"button"}," Sign Up "),r.a.createElement("div",null,r.a.createElement("p",null,"Already have an account?"),r.a.createElement("button",null,"Login")))),this.state.message&&r.a.createElement("div",null," ",this.state.message," ")))}}]),t}(r.a.Component),v=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={email:"",password:"",message:null},a}return Object(g.a)(t,e),Object(i.a)(t,[{key:"genericSync",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(s.a)({},a,n))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),E.a.post("".concat("https://impact-sustainability.herokuapp.com/","/api/login"),this.state,{withCredentials:!0}).then((function(e){var a=e.data.userDoc;t.props.onUserChange(a),t.props.history.push("/")})).catch((function(e){if(e.response.data)return t.setState({message:e.response.data.message})}))}},{key:"render",value:function(){var e=this;console.log("Do I have user in Login: ",this.props.currentUser);var t=this.state,a=t.email,n=t.password;return r.a.createElement("section",null,r.a.createElement("h2",null," Login "),r.a.createElement("form",{onSubmit:function(t){return e.handleSubmit(t)}},r.a.createElement("label",null," Email: "),r.a.createElement("input",{value:a,onChange:function(t){return e.genericSync(t)},type:"email",name:"email",placeholder:"my-email@ironhack.com"}),r.a.createElement("label",null," Password"),r.a.createElement("input",{value:n,onChange:function(t){return e.genericSync(t)},type:"password",name:"password",placeholder:"***********"}),r.a.createElement("button",null," Login ")),this.state.message&&r.a.createElement("div",null," ",this.state.message," "))}}]),t}(r.a.Component),C=a(17),b=a(12);var A=function(e){return null!==e.categoriesFromBackEnd?e.categoriesFromBackEnd.map((function(e,t){return r.a.createElement("div",{className:"card column"},r.a.createElement("header",null,r.a.createElement(b.a,{key:t,to:{pathname:"/category/".concat(e._id),state:{theId:e._id,details:e}}},r.a.createElement("p",{className:"card-header-title is-centered",key:t},e.title))),r.a.createElement("div",{className:"card-content"},r.a.createElement("div",{className:"content"},r.a.createElement("p",{key:t},e.description))))})):"Loading..."},k=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).addNewCategory=function(e){e.preventDefault();var t=Object(C.a)(a.props.categoriesFromBackEnd),n={title:a.state.titleCategory,description:a.state.descriptionCategory,author:a.props.currentUser};t.unshift(n),a.setState({titleCategory:"",descriptionCategory:"",showAddCategoryForm:!1,categoriesList:t}),E.a.post("".concat("https://impact-sustainability.herokuapp.com/","/category/create"),n).then((function(e){a.props.getAllCategories()})).catch((function(e){return console.log("Error while adding the new Category ",e)})),console.log("Author:",a.props.currentUser),console.log("New Category is:",n)},a.updateInput=function(e){a.setState(Object(s.a)({},e.target.name,e.target.value))},a.toggleForm=function(){a.setState({showAddCategoryForm:!a.state.showAddCategoryForm})},a.state={showAddCategoryForm:!1,titleCategory:"",descriptionCategory:"",categoriesFromBackEnd:a.props.categoriesFromBackEnd},a}return Object(g.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return null!==this.props.categoriesFromBackEnd?r.a.createElement("section",{className:"hero is-fullheight-with-navbar"},r.a.createElement("div",{className:"hero-body"},r.a.createElement("div",{className:"container"},r.a.createElement("div",null,r.a.createElement("p",{className:"title is-1"},"Think global"),r.a.createElement("p",{className:"subtitle is-1"},"Act local")),r.a.createElement("section",{className:"section"},r.a.createElement("h3",{className:"title"},"All categories:"),r.a.createElement("div",{className:"columns  $column-gap is-8 is-variable"},r.a.createElement(A,{categoriesFromBackEnd:this.props.categoriesFromBackEnd,className:"column"}))),!this.state.showAddCategoryForm&&this.props.currentUser&&r.a.createElement("button",{onClick:this.toggleForm,className:"button is-success"},"Add New Category"),this.state.showAddCategoryForm&&r.a.createElement("form",{onSubmit:this.addNewCategory},r.a.createElement("h3",null,"Add New Category"),r.a.createElement("p",null,"Title"),r.a.createElement("input",{name:"titleCategory",type:"text",value:this.state.titleCategory,onChange:this.updateInput}),r.a.createElement("p",null,"Description"),r.a.createElement("input",{name:"descriptionCategory",type:"text",value:this.state.descriptionCategory,onChange:this.updateInput}),r.a.createElement("button",null,"Submit"))))):"Loading"}}]),t}(r.a.Component),w=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return console.log("-=-=-=-=-=-",this.props.theUser),r.a.createElement("div",{className:"navbar-menu is-spaced"},r.a.createElement("div",{className:"navbar-start"},this.props.theUser&&r.a.createElement("div",null,r.a.createElement(b.b,{to:"/",className:"navbar-item is-inline"},"Home"),r.a.createElement(b.b,{to:"/dashboard",className:"navbar-item is-inline"},"Dashboard"),r.a.createElement(b.b,{to:"/community",className:"navbar-item is-inline"},"Community"))),r.a.createElement("div",{className:"navbar-end"},this.props.theUser&&r.a.createElement("button",{onClick:this.props.doLogout,className:"button is-transparent is-radiusless"},"Logout"),!this.props.theUser&&r.a.createElement("div",null,r.a.createElement(b.b,{to:"/login-page",className:"navbar-item is-inline"},"Login"),r.a.createElement(b.b,{to:"/signup-page",className:"navbar-item is-inline"}," ","Signup"," "))))}}]),t}(r.a.Component),_=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).handleChangeAct=function(e){var t=a.state.arrayOfActions.filter((function(e){return e.category===a.state.currentCategory._id})).filter((function(t){return t._id!==e}));console.log("".concat("https://impact-sustainability.herokuapp.com/","/act/").concat(e,"/update")),E.a.post("".concat("https://impact-sustainability.herokuapp.com/","/act/").concat(e,"/update"),{},{withCredentials:!0}).then((function(){a.setState({arrayOfActions:t})})).catch((function(e){return console.log("Error while click on `Act Now`",e)}))},a.showCategoryDetails=function(){if(null!==a.props.categoriesFromBackEnd){var e=a.state.arrayOfActions.filter((function(e){return e.category==a.state.currentCategory._id}));return console.log("Current category: ",a.props.location.state.details),r.a.createElement("div",null,r.a.createElement("h2",null,a.state.currentCategory.title),r.a.createElement("p",null,a.state.currentCategory.description),r.a.createElement("b",null,"Actions:"),e.map((function(e,t){return console.log(e),r.a.createElement("div",{key:t},r.a.createElement("p",null,e.title),r.a.createElement("button",{onClick:function(t){a.handleChangeAct(e._id)}},"Act now!"))})))}return"loading"},a.toggleForm=function(){a.setState({showAddActForm:!a.state.showAddActForm})},a.toggleFormCategory=function(){a.setState({showEditCategoryForm:!a.state.showEditCategoryForm})},a.handleChange=function(e){console.log("changing value",e.target.name,e.target.value),a.setState(Object(s.a)({},e.target.name,e.target.value))},a.addNewActToDb=function(e){e.preventDefault(),console.log("#####",a.state);var t=Object(C.a)(a.state.arrayOfActions);console.log("first",t);var n={title:a.state.titleAct,description:a.state.descriptionAct,value:a.state.valueOfAct,category:a.state.actCategory,author:a.props.currentUser};t.unshift(n),a.setState({showAddActForm:!1,titleAct:"",descriptionAct:"",valueOfAct:"",actCategory:"",arrayOfActions:t}),console.log("second",t),E.a.post("".concat("https://impact-sustainability.herokuapp.com/","/act/create"),n).then((function(e){a.props.getAllActions()})).catch((function(e){return console.log("Error while adding the new Act ",e)}))},a.editCategoryInDb=function(e){if(e.preventDefault(),null===a.state.currentCategory)return"loading category...";var t=Object(C.a)(a.state.categoriesFromBackEnd);console.log("Cat first",t);var n={title:a.state.titleCat,description:a.state.description};t.unshift(n),a.setState({showEditCategoryForm:!1,titleCat:"",descriptionCat:""}),console.log("Cat second",t),E.a.post("".concat("https://impact-sustainability.herokuapp.com/","category/").concat(a.state.currentCategory._id,"/update"),n).then((function(e){a.props.getAllCategories()})).catch((function(e){return console.log("Error while editing theCategory ",e)}));a.props.getAllCategories();console.log("Updated",n)},a.state={showAddActForm:!1,titleAct:"",descriptionAct:"",valueOfAct:"",actCategory:"",currentCategory:a.props.location.state.details,arrayOfActions:a.props.actionsFromBackEnd.allActs,categoriesFromBackEnd:a.props.categoriesFromBackEnd,showEditCategoryForm:!1,titleCat:"",descriptionCat:""},a}return Object(g.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this;return null!==this.props.categoriesFromBackEnd?(console.log("Current category",this.state.currentCategory),console.log("current User:",this.props.currentUser._id),r.a.createElement("div",null,this.showCategoryDetails(),r.a.createElement("div",null,r.a.createElement("div",null,!this.state.showAddActForm&&r.a.createElement("button",{onClick:this.toggleForm},"Add New Action"),this.state.showAddActForm&&r.a.createElement("form",{onSubmit:this.addNewActToDb},r.a.createElement("h3",null,"Add New Action"),r.a.createElement("p",null,"Title"),r.a.createElement("input",{name:"titleAct",type:"text",value:this.state.titleAct,onChange:this.handleChange}),r.a.createElement("p",null,"Description"),r.a.createElement("input",{name:"descriptionAct",type:"text",value:this.state.descriptionAct,onChange:this.handleChange}),r.a.createElement("p",null,"Value: "),r.a.createElement("input",{name:"valueOfAct",type:"number",min:"0",value:this.state.valueOfAct,onChange:this.handleChnge}),r.a.createElement("p",null,"Select Category"),r.a.createElement("select",{name:"actCategory",onChange:this.handleChange},r.a.createElement("option",{value:""},"Pick category"),this.props.categoriesFromBackEnd.map((function(e){return r.a.createElement("option",{value:e._id,key:e._id},e.title)}))),r.a.createElement("button",null,"Submit"))),r.a.createElement("p",null,"_________________________"),r.a.createElement("div",null,this.state.currentCategory.author===this.props.currentUser._id&&r.a.createElement("div",null,r.a.createElement("div",null,!this.state.showEditCategoryForm&&r.a.createElement("button",{onClick:this.toggleFormCategory},"Edit Category"),this.state.showEditCategoryForm&&this.props.location.state.details&&r.a.createElement("form",{onSubmit:this.editCategoryInDb},r.a.createElement("h3",null,"Edit ",this.state.currentCategory.title),r.a.createElement("p",null,"Title"),r.a.createElement("input",{name:"titleAct",type:"text",placeholder:this.state.currentCategory.title,value:this.state.titleAct,onChange:this.handleChange}),r.a.createElement("p",null,"Description"),r.a.createElement("textarea",{name:"descriptionAct",type:"text",placeholder:this.state.currentCategory.description,value:this.state.descriptionAct,onChange:this.handleChange}),r.a.createElement("button",null,"Save Changes"))),r.a.createElement("div",null,r.a.createElement("button",{onClick:function(){e.props.getCategoryObjforDelete(e.props.location.state.details)}},"Delete Category"," "))))))):"Loading..."}}]),t}(r.a.Component),S=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).getLessSuggestedActs=function(){if(console.log("All",a.state.treatedSuggestedActs),null!==a.state.treatedSuggestedActs)return console.log("cut suggested acts:",a.state.treatedSuggestedActs),r.a.createElement("div",null,r.a.createElement("p",null,"Suggested Acts:"),a.state.treatedSuggestedActs.filter((function(e,t){return t<4})).map((function(e,t){return r.a.createElement("div",null,r.a.createElement("h4",null,r.a.createElement("b",null,e.title)," "),r.a.createElement("p",null,e.value),r.a.createElement("p",null,e.category),r.a.createElement("button",{onClick:function(t){a.handleChangeAct(e._id)}},"Act Now!"))})),r.a.createElement("button",{onClick:a.getAllSuggestedActs},"View All suggested Acts"))},a.handleChangeAct=function(e){if(null!==a.state.treatedSuggestedActs){var t=a.state.treatedSuggestedActs.filter((function(t){return t._id!==e})),n=a.state.treatedSuggestedActs.filter((function(t){return t._id===e}));console.log("SCORE",a.state.score);var r=n[0].value+a.state.score;console.log("To add",r),E.a.post("".concat("https://impact-sustainability.herokuapp.com/","/act/").concat(e,"/update"),{},{withCredentials:!0}).then((function(){a.setState({treatedSuggestedActs:t,score:r})})).catch((function(e){return console.log("Error while click on `Act Now`",e)}))}},a.getAllSuggestedActs=function(){return console.log("MOREEEEEEE"),r.a.createElement("h2",null,"MORE")},a.handleViewDetails=function(){return a.setState({detailsUnfolded:!0}),r.a.createElement("div",null,r.a.createElement("p",null,"Completed acts:"),a.props.currentUser.completedActs.map((function(e,t){return r.a.createElement("div",{key:t},r.a.createElement("p",null,e,e.title," ",e.value))})))},a.toggleForm=function(){a.setState({detailsUnfolded:!a.state.detailsUnfolded})},a.state={treatedSuggestedActs:null,detailsUnfolded:!1,suggestedActs:a.props.currentUser.suggestedActs.slice(0,4),score:a.props.currentUser.score},a}return Object(g.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){for(var e=this,t=[],a=0;a<this.props.currentUser.suggestedActs.length;a++)for(var n=0;n<this.props.actionsFromBackEnd.allActs.length;n++)this.props.actionsFromBackEnd.allActs[n]._id===this.props.currentUser.suggestedActs[a]&&t.unshift(this.props.actionsFromBackEnd.allActs[n]);console.log("****",t),this.setState({treatedSuggestedActs:t},(function(){return console.log("####",e.state.treatedSuggestedActs)}))}},{key:"render",value:function(){return null!==this.props.currentUser?(console.log(">>>>>>>>>>>>>>>>>>",this.state.treatedSuggestedActs),r.a.createElement("div",null,r.a.createElement("h2",null,"Hi there, ",this.props.currentUser.fullName),r.a.createElement("h4",null,"Your score is ",this.state.score),!this.state.detailsUnfolded&&r.a.createElement("button",{onClick:this.toggleForm},"View Details"),this.state.detailsUnfolded&&r.a.createElement("div",null,r.a.createElement("p",null,"Completed acts:"),this.state.treatedSuggestedActs.map((function(e,t){return r.a.createElement("div",null,r.a.createElement("div",{key:t},r.a.createElement("b",null,e.title)," ",e.value))})),r.a.createElement("button",{onClick:this.toggleForm},"Show Less")),r.a.createElement("p",null,"________________________________"),this.getLessSuggestedActs())):"Loading..."}}]),t}(r.a.Component),F=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).getAllCategories=function(){E.a.get("".concat("https://impact-sustainability.herokuapp.com/","/category/allCats")).then((function(e){console.log("Categories from DB: ",e.data.allCategories),a.setState({categoriesFromBackEnd:e.data.allCategories})})).catch((function(e){return console.log("Err while getting categories: ",e)}))},a.getAllActions=function(){E.a.get("".concat("https://impact-sustainability.herokuapp.com/","/acts")).then((function(e){console.log("Actions are: ",e.data),a.setState({actionsFromBackEnd:e.data})})).catch((function(e){return console.log("Err while getting actions: ",e)}))},a.logout=function(){a.setState({currentUser:null}),E.a.delete("".concat("https://impact-sustainability.herokuapp.com/","/api/logout"),{withCredentials:!0}).then((function(){a.props.history.push("/")})).catch((function(e){return console.log("error while logging out ",e)}))},a.deleteCategory=function(e){if(null===e)return"loading";var t=e._id;console.log("The id: ",t),E.a.post("".concat("https://impact-sustainability.herokuapp.com/","/category/").concat(t,"/delete")).then((function(t){var n=a.state.categoriesFromBackEnd.filter((function(t){return t._id!==e._id}));a.setState({categoriesFromBackEnd:n}),console.log("helllooooo: =-=-=-=-=-=-=-=-=-= ",h),h.push("/")})).catch((function(e){return console.log("Error while deleteing the category ",e)}))},a.editCategory=function(e){console.log("do i have cat here: ",e.title)},a.state={currentUser:null,categoriesFromBackEnd:null,actionsFromBackEnd:null},a}return Object(g.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;E.a.get("".concat("https://impact-sustainability.herokuapp.com/","/api/checkuser"),{withCredentials:!0}).then((function(t){var a=t.data.userDoc;e.syncCurrentUSer(a)})).catch((function(e){return console.log("Err while getting the user from the checkuser route: ",e)})),this.getAllCategories(),this.getAllActions()}},{key:"syncCurrentUSer",value:function(e){console.log("current usre info ---- ",e),this.setState({currentUser:e})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("div",{className:""},r.a.createElement("header",{className:"container"},r.a.createElement(w,{theUser:this.state.currentUser,doLogout:this.logout,className:"navbar is-fixed-top is-primary",role:"navigation","aria-label":"main navigation"})),r.a.createElement(f.c,null,r.a.createElement(f.a,{exact:!0,path:"/signup-page",render:function(t){return r.a.createElement(y,Object.assign({},t,{currentUser:e.state.currentUser,onUserChange:function(t){return e.syncCurrentUSer(t)}}))}}),r.a.createElement(f.a,{exact:!0,path:"/login-page",render:function(t){return r.a.createElement(v,Object.assign({},t,{currentUser:e.state.currentUser,onUserChange:function(t){return e.syncCurrentUSer(t)}}))}}),r.a.createElement(f.a,{exact:!0,path:"/",render:function(t){return r.a.createElement(k,Object.assign({},t,{getAllCategories:e.getAllCategories,currentUser:e.state.currentUser,categoriesFromBackEnd:e.state.categoriesFromBackEnd,actionsFromBackEnd:e.state.actionsFromBackEnd}))}}),r.a.createElement(f.a,{exact:!0,path:"/",render:function(t){return r.a.createElement(A,Object.assign({},t,{currentUser:e.state.currentUser,categoriesFromBackEnd:e.state.categoriesFromBackEnd,actionsFromBackEnd:e.state.actionsFromBackEnd}))}}),r.a.createElement(f.a,{path:"/category/",render:function(t){return r.a.createElement(_,Object.assign({},t,{getCategoryObjforEdit:function(t){return e.editCategory(t)},getCategoryObjforDelete:function(t){return e.deleteCategory(t)},getAllActions:e.getAllActions,getAllCategories:e.getAllCategories,currentUser:e.state.currentUser,categoriesFromBackEnd:e.state.categoriesFromBackEnd,actionsFromBackEnd:e.state.actionsFromBackEnd}))}}),r.a.createElement(f.a,{exact:!0,path:"/dashboard",render:function(t){return r.a.createElement(S,Object.assign({},t,Object(s.a)({getAllActions:e.getAllActions,currentUser:e.state.currentUser,categoriesFromBackEnd:e.state.categoriesFromBackEnd,actionsFromBackEnd:e.state.actionsFromBackEnd},"currentUser",e.state.currentUser)))}}))))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(63);c.a.render(r.a.createElement(f.b,{history:h},r.a.createElement(F,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[34,1,2]]]);
//# sourceMappingURL=main.d6e1ec86.chunk.js.map